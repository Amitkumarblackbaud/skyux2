<sky-demo-nav></sky-demo-nav>

<stache pageTitle="Component libraries" showTableOfContents="true">
  <stache-page-summary>
    This page documents how to create a reusable component library for SKY UX.
  </stache-page-summary>

  <stache-page-anchor>
    Overview
  </stache-page-anchor>

  <stache-page-anchor>
    Installing dependencies
  </stache-page-anchor>

  <p>
    The following command will create a new SKY UX SPA with features that will help you author a component library.
  </p>

  <stache-code-block>
    skyux new --template library
  </stache-code-block>

  <stache-page-anchor>
    Creating the library
  </stache-page-anchor>

  <p>
    The library source files live in <strong>/src/app/public</strong>. This folder is special in that SKY UX Builder will ignore components saved here (ie, the components will not be automatically declared in the <stache-code>SkyModule</stache-code>). This will allow you to write Angular modules, components, and services outside of SKY UX's scope.
  </p>

  <p>
    The entry point for your component library is <strong>/src/app/public/index.ts</strong>. This file is responsible for exporting any code you want to be made available to the bundler.
  </p>

  <stache-page-anchor>
    Building your library
  </stache-page-anchor>

  <stache-code-block>
    skyux build-public-library
  </stache-code-block>

  <stache-page-anchor>
    Publishing your library
  </stache-page-anchor>

  <p>
    (Add notes here about NPM feeds for both public and private libraries.)
  </p>

  <h3>
    Publishing to npmjs.org
  </h3>

  <h3>
    Publishing to Blackbaud's NPM stream
  </h3>

  <stache-page-anchor>
    Consuming your library in another SPA
  </stache-page-anchor>

  <p>
    <strong>/app/src/app-extras.module.ts</strong>
  </p>
  <stache-code-block languageType="typescript">
    import { NgModule } from '@angular/core';

    import { LibraryModule } from 'my-component-library';

    @NgModule({
      imports: [
        LibraryModule
      ],
      exports: [
        LibraryModule
      ]
    })
    export class AppExtrasModule { }
  </stache-code-block>

  <stache-page-anchor>
    Accessing the consuming app's configuration
  </stache-page-anchor>

  <p>
    (Provide reasons for why SkyAppConfig cannot be accessed by the component library. Why we need to create the adaptor, etc.)
  </p>

  <p>
    <strong>/skyuxconfig.json</strong>
  </p>

  <stache-code-block languageType="json">
    {
      "app": {
        "title": "My Application"
      }
    }
  </stache-code-block>

  <p>
    <strong>/app/src/app-extras.module.ts</strong>
  </p>

  <stache-code-block languageType="typescript">
    import { NgModule } from '@angular/core';

    import { SkyAppConfig } from '@blackbaud/skyux-builder/runtime';

    import { LibraryModule, LibraryConfigService } from 'my-component-library';

    @NgModule({
      imports: [
        LibraryModule
      ],
      exports: [
        LibraryModule
      ],
      providers: [
        // The config service acts as an adaptor for skyuxconfig.json:
        {
          provide: LibraryConfigService,
          useExisting: SkyAppConfig
        }
      ]
    })
    export class AppExtrasModule { }
  </stache-code-block>

  <stache-page-anchor>
    Providing configuration for your library
  </stache-page-anchor>

  <p>
    <strong>/skyuxconfig.json</strong>
  </p>

  <stache-code-block languageType="json">
    {
      "appSettings": {
        "myLibrary": {
          "foo": "bar",
          "baz": true
        }
      }
    }
  </stache-code-block>

  <p>
    <strong>/app/src/public/src/modules/shared/config.service.ts</strong>
  </p>

  <stache-code-block languageType="typescript">
    import { LibraryConfigService } from '../shared';

    @Component({ ... })
    export class MyLibraryComponent {
      constructor(public configService: LibraryConfigService) {
        console.log(configService.appSettings.myLibrary.foo); // "bar"
      }
    }

  </stache-code-block>
</stache>
